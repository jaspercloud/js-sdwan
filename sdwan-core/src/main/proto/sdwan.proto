syntax = "proto2";
option java_package = "io.jaspercloud.sdwan.core.proto";
option java_outer_classname = "SDWanProtos";

enum MessageCode {
  Success = 0;
  NodeTypeError = 1;
  NotEnough = 2;
}

enum MsgTypeCode {
  HeartType = 1;
  RegReqType = 2;
  RegRespType = 3;
  SDArpReqType = 4;
  SDArpRespType = 5;
  RefreshRouteList = 6;
  PunchingType = 7;
}

message Message {
  required string reqId = 1;
  required MsgTypeCode type = 2;
  optional bytes data = 3;
}

enum NodeTypeCode {
  SimpleType = 1;
  MeshType = 2;
}

message RegReq {
  required NodeTypeCode nodeType = 1;
  required string macAddress = 2;
  required string stunMapping = 3;
  required string stunFiltering = 4;
  optional string publicIP = 5;
  optional int32 publicPort = 6;
}

message RegResp {
  required int32 code = 1;
  optional string vip = 2;
  optional int32 maskBits = 3;
  repeated string route = 4;
}

message SDArpReq {
  required string ip = 1;
}

message SDArpResp {
  required int32 code = 1;
  optional string vip = 2;
  optional string stunMapping = 3;
  optional string stunFiltering = 4;
  optional string publicIP = 5;
  optional int32 publicPort = 6;
  optional int32 ttl = 7;
}

message RouteList {
  repeated string route = 1;
}

message Punching {
  required string srcVIP = 1;
  required string dstVIP = 2;
  required string srcIP = 3;
  required int32 srcPort = 4;
  required string tranId = 5;
}